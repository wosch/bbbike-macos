#!/bin/sh
# Copyright (c) Wolfram Schneider, Aug 2008
#
# bbbike - a wrapper for the perl/tk program BBBike.
#
# BBBike is a route-finder for cyclists in Berlin and Brandenburg
# see http://www.bbbike.de
#
# $Id: bbbike,v 1.29 2009/03/08 16:12:09 wosch Exp $
##################################################################################

# BBBike version
bbbike_version="BBBike-3.17-devel"

# BBBike options
additional_layers="--sehenswuerdigkeiten --rbahn"
advanced_mode=	#"--advanced"


##################################################################################
# perl version
perl_version="5.10.0"

# $0 may contain spaces: /Volumes/bbbike 1/BBBike/bbbike
dir=`dirname "$0"`

# perl/TK binary installation for perl-5.10.0
perl_home="$dir"/.perl-$perl_version

DYLD_LIBRARY_PATH="$perl_home/lib/5.10.0/darwin-thread-multi-2level/CORE"
export DYLD_LIBRARY_PATH


##################################################################################
case `sysctl -n hw.machine` in
        i386) ;;
        * ) banner '.'; echo "Wrong architecture, only MacOS/Intel is supported"; exit 1 ;;
esac
case `sw_vers -productVersion` in
        10.[5-9].* ) ;;
        * ) banner '.'; echo "Wrong MacOS release, only 10.5.X or higher is supported"; exit 1 ;;
esac

datadir=data

case $0 in
        *Aachen* )      datadir=data-osm/Aachen ;;
        *Amsterdam* )   datadir=data-osm/Amsterdam ;;
        *Austin* )      datadir=data-osm/Austin ;;
        *Basel* )       datadir=data-osm/Basel ;;
        *Bielefeld* )   datadir=data-osm/Bielefeld ;;
        *Bonn* )        datadir=data-osm/Bonn ;;
        *Bremen* )      datadir=data-osm/Bremen ;;
        *Cambridge* )   datadir=data-osm/Cambridge ;;
        *Colmar* | *Kolmar* )   datadir=data-osm/Colmar ;;
        *Copenhagen* )  datadir=data-osm/Copenhagen ;;
        *Cracow* | *Krakau* )   datadir=data-osm/Cracow ;;
        *Dresden* )     datadir=data-osm/Dresden ;;
        *Duesseldorf* ) datadir=data-osm/Duesseldorf ;;
        *Erfurt* )      datadir=data-osm/Erfurt ;;
        *Erlangen* )    datadir=data-osm/Erlangen ;;
        *Frankfurt* )   datadir=data-osm/Frankfurt ;;
        *Freiburg* )    datadir=data-osm/Freiburg ;;
        *Goettingen* )  datadir=data-osm/Goettingen ;;
        *Hamburg* )     datadir=data-osm/Hamburg ;;
        *Hannover* )    datadir=data-osm/Hannover ;;
        *Jena* )        datadir=data-osm/Jena ;;
        *Karlsruhe* )   datadir=data-osm/Karlsruhe ;;
        *Koeln* )       datadir=data-osm/Koeln ;;
        *Laibach* | *Ljubljana* ) datadir=data-osm/Laibach;;
        *Leipzig* )     datadir=data-osm/Leipzig ;;
        *Luebeck* )     datadir=data-osm/Luebeck ;;
        *Mainz* )       datadir=data-osm/Mainz ;;
        *Muenster* )    datadir=data-osm/Muenster ;;
        *New_York* )    datadir=data-osm/New_York ;;
        *Portland* )    datadir=data-osm/Portland ;;
        *Providence* )  datadir=data-osm/Providence ;;
        *Rostock* )     datadir=data-osm/Rostock ;;
        *Ruegen* )      datadir=data-osm/Ruegen ;;
        *San_Francisco* )       datadir=data-osm/San_Francisco ;;
        *Santa_Cruz* )  datadir=data-osm/Santa_Cruz ;;
        *Strassburg* )  datadir=data-osm/Strassburg ;;
        *Wien* )        datadir=data-osm/Wien ;;
        *Zuerich* )     datadir=data-osm/Zuerich ;;
esac


# Languate is German by default
export LANG=de_DE.UTF-8;

# start english version of BBBike
case $0 in
	*Amsterdam* | \
	*Austin* | \
	*Cambridge* | \
	*Cracow* | \
	*Copenhagen* | \
	*Laibach* | *Ljubljana* | \
	*New_York* | \
	*Portland* | \
	*Providence* | \
	*San_Francisco* | \
	*Santa_Cruz* ) export LANG=en_US.UTF-8;;
esac

##################################################################################

exec "$perl_home"/bin/perl \
	-I"$perl_home"/lib/$perl_version/darwin-thread-multi-2level \
     	-I"$perl_home"/lib/$perl_version \
	-I"$perl_home"/lib/site_perl/$perl_version/darwin-thread-multi-2level \
	-I"$perl_home"/lib/site_perl/$perl_version \
   "$dir"/.$bbbike_version/bbbike \
	-datadir "$dir/.$bbbike_version/$datadir" \
	$additional_layers $advanced_mode "$@"

