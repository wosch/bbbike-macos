#!/bin/sh
# Copyright (c) Wolfram Schneider, Aug 2008
#
# bbbike - a wrapper for the perl/tk program BBBike.
#
# BBBike is a route-finder for cyclists in Berlin and Brandenburg
# see http://www.bbbike.de
#
# $Id: bbbike,v 1.25 2008/12/10 23:03:04 wosch Exp $
##################################################################################

# BBBike version
bbbike_version="BBBike-3.17-devel"

# BBBike options
additional_layers="--sehenswuerdigkeiten --rbahn"
advanced_mode=	#"--advanced"


##################################################################################
# perl version
perl_version="5.10.0"

# $0 may contain spaces: /Volumes/bbbike 1/BBBike/bbbike
dir=`dirname "$0"`

# perl/TK binary installation for perl-5.10.0
perl_home="$dir"/.perl-$perl_version

DYLD_LIBRARY_PATH="$perl_home/lib/5.10.0/darwin-thread-multi-2level/CORE"
export DYLD_LIBRARY_PATH


##################################################################################
case `sysctl -n hw.machine` in
        i386) ;;
        * ) banner '.'; echo "Wrong architecture, only MacOS/Intel is supported"; exit 1 ;;
esac
case `sw_vers -productVersion` in
        10.[5-9].* ) ;;
        * ) banner '.'; echo "Wrong MacOS release, only 10.5.X or higher is supported"; exit 1 ;;
esac

datadir=data

case $0 in
	*Amsterdam* ) 	datadir=data-osm/Amsterdam ;;
	*Austin* ) 	datadir=data-osm/Austin ;;
	*Basel* ) 	datadir=data-osm/Basel ;;
	*Cambridge* ) 	datadir=data-osm/Cambridge ;;
	*Colmar* | *Kolmar* ) 	datadir=data-osm/Colmar ;;
	*Cracow* | *Krakau* ) 	datadir=data-osm/Cracow ;;
	*Copenhagen* ) 	datadir=data-osm/Copenhagen ;;
	*Erlangen* ) 	datadir=data-osm/Erlangen ;;
	*Freiburg* ) 	datadir=data-osm/Freiburg ;;
	*Hannover* ) 	datadir=data-osm/Hannover ;;
	*Karlsruhe* ) 	datadir=data-osm/Karlsruhe ;;
	*Laibach* | *Ljubljana* ) datadir=data-osm/Laibach;;
	*New_York* ) 	datadir=data-osm/New_York ;;
	*Portland* ) 	datadir=data-osm/Portland ;;
	*San_Francisco* ) 	datadir=data-osm/San_Francisco ;;
	*Santa_Cruz* ) 	datadir=data-osm/Santa_Cruz ;;
	*Toronto* ) 	datadir=data-osm/Toronto ;;
	*Wien* ) 	datadir=data-osm/Wien ;;
	*Zuerich* ) 	datadir=data-osm/Zuerich ;;
esac


# Languate is German by default
export LANG=de_DE.UTF-8;

# start english version of BBBike
case $0 in
	*Amsterdam* | \
	*Austin* | \
	*Cambridge* | \
	*Cracow* | \
	*Copenhagen* | \
	*Laibach* | *Ljubljana* | \
	*New_York* | \
	*Portland* | \
	*San_Francisco* | \
	*Toronto* | \
	*Santa_Cruz* ) export LANG=en_US.UTF-8;;
esac

##################################################################################

exec "$perl_home"/bin/perl \
	-I"$perl_home"/lib/$perl_version/darwin-thread-multi-2level \
     	-I"$perl_home"/lib/$perl_version \
	-I"$perl_home"/lib/site_perl/$perl_version/darwin-thread-multi-2level \
	-I"$perl_home"/lib/site_perl/$perl_version \
   "$dir"/.$bbbike_version/bbbike \
	-datadir "$dir/.$bbbike_version/$datadir" \
	$additional_layers $advanced_mode "$@"

