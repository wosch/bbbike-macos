#!/bin/sh
#
# Wolfram Schneider, Aug 2008
#
# bbbike - a wrapper for the perl program BBBike - a route-finder for 
#          cyclists in Berlin and Brandenburg, http://www.bbbike.de

# $0 may contain spaces: /Volumes/bbbike 1/BBBike/bbbike
dir=`dirname "$0"`

# perl/TK binary installation for perl-5.10.0
perl_home="$dir"/.perl-5.10.0

export DYLD_LIBRARY_PATH="$perl_home/lib/5.10.0/darwin-thread-multi-2level/CORE"

# start english version of BBBike
export LANG=en_US.UTF-8


case `uname -m` in
        i386) ;;
        * ) banner '.'; echo "Wrong architecture, only MacOS/Intel is supported"; exit 1 ;;
esac
case `sw_vers -productVersion` in
        10.[5-9].* ) ;;
        * ) banner '.'; echo "Wrong MacOS release, only 10.5.X or higher is supported"; exit 1 ;;
esac

datadir=data
lazy="-lazy" # workaround for bugs in XS code

case $0 in
	*Amsterdam* ) 	datadir=data-osm/Amsterdam ;;
	*Basel* ) 	datadir=data-osm/Basel ;;
	*Colmar* | *Kolmar* ) datadir=data-osm/Colmar ;;
	*Copenhagen* ) 	datadir=data-osm/Copenhagen ;;
	*Erlangen* ) 	datadir=data-osm/Erlangen ;;
	*Freiburg* ) 	datadir=data-osm/Freiburg ;;
	*Hannover* ) 	datadir=data-osm/Hannover ;;
	*Karlsruhe* ) 	datadir=data-osm/Karlsruhe ;;
	*Laibach* | *Ljubljana* ) datadir=data-osm/Laibach;;
	*San_Francisco* ) datadir=data-osm/San_Francisco ;;
	*Wien* ) 	datadir=data-osm/Wien ;;
	*Zuerich* ) 	datadir=data-osm/Zuerich ;;
esac

"$perl_home"/bin/perl \
	-I"$perl_home"/lib/5.10.0/darwin-thread-multi-2level \
     	-I"$perl_home"/lib/5.10.0 \
	-I"$perl_home"/lib/site_perl/5.10.0/darwin-thread-multi-2level \
	-I"$perl_home"/lib/site_perl/5.10.0 \
   "$dir"/.BBBike-3.16/bbbike $lazy -datadir "$dir/.BBBike-3.16/$datadir" "$@"

