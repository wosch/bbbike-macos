#!/opt/local/bin/perl 
# -*- perl -*-

use IO::File;

use strict;
use warnings;

use vars qw($VERSION);
$VERSION = 0.1;

my %hash;

my $streets = $ARGV[0];
my $points  = $ARGV[1];

die "usage: $0 streetdb pointdb\n" if ( $streets && $points );

my $s = new IO::File $streets, "r" or die "open $streets: $!\n";
while (<$s>) {
    chomp;
    my ( $point, $street ) = split(/\t/);
    push( @{ $hash{$point} }, $street );
}

my $p = new IO::File $points, "r" or die "open $points: $!\n";
while (<$p>) {
    chomp;
    my ( $point, $lon, $lat ) = split(/\t/);

    if ( exists $hash{$point} ) {
        foreach my $street ( @{ $hash{$point} } ) {
            print $street, "\t", $lon, "\t", $lat, "\n";
        }
    }

}
